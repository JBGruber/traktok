<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="traktok">
<title>Unofficial API • traktok</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Unofficial API">
<meta property="og:description" content="traktok">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">traktok</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/research-api.html">Research API</a>
    <a class="dropdown-item" href="../articles/unofficial-api.html">Unofficial API</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JBGruber/traktok/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Unofficial API</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JBGruber/traktok/blob/HEAD/vignettes/unofficial-api.Rmd" class="external-link"><code>vignettes/unofficial-api.Rmd</code></a></small>
      <div class="d-none name"><code>unofficial-api.Rmd</code></div>
    </div>

    
    
<p>The unofficial or hidden API is essentially what the TikTok website
uses to display you content. Partly based on <a href="https://github.com/dfreelon/pyktok" class="external-link">Deen Freelon’s
<code>Pyktok</code> Python module</a>, <code>traktok</code> contains
functions to simulate a browser accessing some of these API endpoints.
How these endpoints work was discovered through reverse engineering and
TikTok might change how these endpoints operate at any moment. As of
writing this (2023-11-28), there are functions that can:</p>
<ul>
<li>search videos using a search term</li>
<li>get video details and the video files from a given video URL</li>
<li>get who follows a user</li>
<li>get who a user is following</li>
</ul>
<p>To use these functions, you have to log into &lt;tiktok.com&gt; first
and then give <code>R</code> the cookies the browser uses to identify
itself.</p>
<div class="section level2">
<h2 id="authentication">Authentication<a class="anchor" aria-label="anchor" href="#authentication"></a>
</h2>
<p>The easiest way to get the cookies needed for authentication is to
export the necessary cookies from your browser using a browser extension
(after logging in at TikTok.com at least once). I can recommend <a href="https://chrome.google.com/webstore/detail/get-cookiestxt-locally/cclelndahbckbenkjhflpdbgdldlbecc" class="external-link">“Get
cookies.txt”</a> for Chromium based browsers or <a href="https://addons.mozilla.org/en-US/firefox/addon/cookies-txt/" class="external-link">“cookies.txt”</a>
for Firefox (note that almost all browsers used today are based on one
of these).</p>
<p><img src="cookies.png" width="1260"></p>
<p>Save the cookies.txt file, which will look something like this:</p>
<pre><code># Netscape HTTP Cookie File
# https://curl.haxx.se/rfc/cookie_spec.html
# This is a generated file! Do not edit.

.tiktok.com TRUE    /   TRUE    1728810805  cookie-consent  {%22ga%22:true%2C%22af%...
.tiktok.com TRUE    /   TRUE    1700471788  passport_csrf_token e07d3487c11ce5258a3...
.tiktok.com TRUE    /   FALSE   1700471788  passport_csrf_token_default e07d3487c11...
#HttpOnly_.tiktok.com   TRUE    /   TRUE    1700493610  multi_sids  71573310862246389...
#HttpOnly_.tiktok.com   TRUE    /   TRUE    1700493610  cmpl_token  AgQQAPORF-RO0rNtH...
...</code></pre>
<p><strong>It does not matter if you download all cookies or just the
ones specific to TikTok</strong>, as we use the
<code>cookiemonster</code> package to deal with that. To read the
cookies into a specific encrypted file, simply use:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cookiemonster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cookiemonster/man/add_cookies.html" class="external-link">add_cookies</a></span><span class="op">(</span><span class="st">"tiktok.com_cookies.txt"</span><span class="op">)</span></span></code></pre></div>
<p>And that’s it! <code>traktok</code> will access these cookies
whenever necessary.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="section level3">
<h3 id="search-videos">Search videos<a class="anchor" aria-label="anchor" href="#search-videos"></a>
</h3>
<p>To search for videos, you can use either <code>tt_search</code> or
<code>tt_search_hidden</code>, which do the same, as long as you do not
have a token for the Research API. To get the first two pages of search
results (one page has 12 videos), you can use this command:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>rstats_df <span class="ot">&lt;-</span> <span class="fu">tt_search_hidden</span>(<span class="st">"#rstats"</span>, <span class="at">max_pages =</span> <span class="dv">2</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>ℹ Getting page <span class="dv">1</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>⏲ waiting <span class="fl">0.5</span> seconds</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>ℹ Getting page <span class="dv">1</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>✔ Got page <span class="fl">1.</span> Found <span class="dv">12</span> videos. [<span class="fl">1.9</span>s]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>ℹ Getting page <span class="dv">2</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>✔ Got page <span class="fl">2.</span> Found <span class="dv">12</span> videos. [690ms]</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>rstats_df</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 24 × 20</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    video_id  video_timestamp     video_url video_length video_title</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;     &lt;dttm&gt;              &lt;glue&gt;           &lt;int&gt; &lt;chr&gt;      </span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 71151144… 2022-06-30 19:17:53 https://…          135 "R for Beg…</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 72522261… 2023-07-05 07:01:45 https://…           36 "Wow!!! TH…</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 72420686… 2023-06-07 22:05:16 https://…           34 "R GRAPHIC…</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 72134135… 2023-03-22 16:49:12 https://…            6 "R and me …</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 72576898… 2023-07-20 00:23:40 https://…           56 "Pie chart…</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 72999870… 2023-11-10 23:58:21 https://…           51 "Quick R Q…</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 72783048… 2023-09-13 13:40:21 https://…           36 "Quick R Q…</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 73029706… 2023-11-19 00:56:09 https://…          163 "What is c…</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 71670108… 2022-11-17 15:42:56 https://…           58 "Here’s an…</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 72933174… 2023-10-24 00:36:48 https://…            9 "#CapCut #…</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 14 more rows</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 15 more variables: video_diggcount &lt;int&gt;,</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   video_sharecount &lt;int&gt;, video_commentcount &lt;int&gt;,</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   video_playcount &lt;int&gt;, video_is_ad &lt;lgl&gt;, author_name &lt;chr&gt;,</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   author_nickname &lt;chr&gt;, author_followercount &lt;int&gt;,</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   author_followingcount &lt;int&gt;, author_heartcount &lt;int&gt;,</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   author_videocount &lt;int&gt;, author_diggcount &lt;int&gt;, …</span></span></code></pre></div>
<p>This already gives you pretty much all information you could want
about the videos that were found.</p>
</div>
<div class="section level3">
<h3 id="get-metadata-and-download-videos">Get metadata and download videos<a class="anchor" aria-label="anchor" href="#get-metadata-and-download-videos"></a>
</h3>
<p>However, you can obtain some more information, and importantly the
video file, using <code>tt_videos</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>rstats_df2 <span class="ot">&lt;-</span> <span class="fu">tt_videos</span>(rstats_df<span class="sc">$</span>video_url[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">save_video =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>ℹ Getting video <span class="dv">7115114419314560298</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>⏲ waiting <span class="fl">0.2</span> seconds              </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>ℹ Getting video <span class="dv">7115114419314560298</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>✔ Got video <span class="dv">7115114419314560298</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>). File size<span class="sc">:</span> <span class="fl">2.5</span> Mb. [<span class="fl">2.5</span>s]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>ℹ Getting video <span class="dv">7252226153828584731</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>✔ Got video <span class="dv">7252226153828584731</span> (<span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>). File size<span class="sc">:</span> <span class="fl">1.7</span> Mb. [999ms]</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>rstats_df2</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 19</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   video_id   video_url video_timestamp     video_length video_title</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;glue&gt;     &lt;chr&gt;     &lt;dttm&gt;                     &lt;int&gt; &lt;chr&gt;      </span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 711511441… https://… 2022-06-30 19:17:53          135 R for Begi…</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 725222615… https://… 2023-07-05 07:01:45           36 Wow!!! THI…</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 14 more variables: video_locationcreated &lt;chr&gt;,</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   video_diggcount &lt;int&gt;, video_sharecount &lt;int&gt;,</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   video_commentcount &lt;int&gt;, video_playcount &lt;int&gt;,</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   author_username &lt;chr&gt;, author_nickname &lt;chr&gt;,</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   author_bio &lt;chr&gt;, download_url &lt;chr&gt;, html_status &lt;int&gt;,</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   music &lt;list&gt;, challenges &lt;list&gt;, is_classified &lt;lgl&gt;,</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   video_fn &lt;chr&gt;</span></span></code></pre></div>
<p>Per default, the function waits between one and ten seconds (chosen
at random) between making two calls, to not make it too obvious that
data is scraped from TikTok. You can speed up the process (at your own
risk), by changing the <code>sleep_pool</code> argument, which controls
the minimum and maximum number of seconds to wait:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>rstats_df3 <span class="ot">&lt;-</span> <span class="fu">tt_videos</span>(rstats_df<span class="sc">$</span>video_url[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">save_video =</span> <span class="cn">TRUE</span>, <span class="at">sleep_pool =</span> <span class="fl">0.1</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>ℹ Getting video <span class="dv">7242068680484408581</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>⏲ waiting <span class="fl">0.1</span> seconds              </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>ℹ Getting video <span class="dv">7242068680484408581</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>✔ Got video <span class="dv">7242068680484408581</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>). File size<span class="sc">:</span> <span class="fl">1.8</span> Mb. [<span class="fl">2.6</span>s]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>ℹ Getting video <span class="dv">7213413598998056234</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>✔ Got video <span class="dv">7213413598998056234</span> (<span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>). File size<span class="sc">:</span> <span class="fl">598.1</span> Kb. [<span class="fl">1.7</span>s]</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>rstats_df3</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 19</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   video_id   video_url video_timestamp     video_length video_title</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;glue&gt;     &lt;chr&gt;     &lt;dttm&gt;                     &lt;int&gt; &lt;chr&gt;      </span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 724206868… https://… 2023-06-07 22:05:16           34 "R GRAPHIC…</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 721341359… https://… 2023-03-22 16:49:12            6 "R and me …</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 14 more variables: video_locationcreated &lt;chr&gt;,</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   video_diggcount &lt;int&gt;, video_sharecount &lt;int&gt;,</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   video_commentcount &lt;int&gt;, video_playcount &lt;int&gt;,</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   author_username &lt;chr&gt;, author_nickname &lt;chr&gt;,</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   author_bio &lt;chr&gt;, download_url &lt;chr&gt;, html_status &lt;int&gt;,</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   music &lt;list&gt;, challenges &lt;list&gt;, is_classified &lt;lgl&gt;,</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   video_fn &lt;chr&gt;</span></span></code></pre></div>
<p>When you are scraping a lot of URLs, the function might fail
eventually, due to a poor connection or because TikTok is blocking your
requests. It therefore usually makes sense to save your progress in a
cache directory:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>rstats_df3 <span class="ot">&lt;-</span> <span class="fu">tt_videos</span>(rstats_df<span class="sc">$</span>video_url[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">cache_dir =</span> <span class="st">"rstats"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ℹ Getting video <span class="dv">7257689890245201153</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>⏲ waiting <span class="fl">1.7</span> seconds</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>ℹ Getting video <span class="dv">7257689890245201153</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>✔ Got video <span class="dv">7257689890245201153</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>). File size<span class="sc">:</span> <span class="fl">1.7</span> Mb. [<span class="fl">2.6</span>s]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>ℹ Getting video <span class="dv">7299987059417042209</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>✔ Got video <span class="dv">7299987059417042209</span> (<span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>). File size<span class="sc">:</span> <span class="fl">1.2</span> Mb. [<span class="fl">1.8</span>s]</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">list.files</span>(<span class="st">"rstats"</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "7257689890245201153.json" "7299987059417042209.json"</span></span></code></pre></div>
<p>Note that the video files are downloaded into the <code>dir</code>
directory (your working directory by default), independently from your
cache directory.</p>
<p>If there are information that you feel are missing from the
<code>data.frame</code> <code>tt_videos</code> returns, you can look at
the raw, unparsed json data using:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rstats_list1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tt_request_hidden.html">tt_request_hidden</a></span><span class="op">(</span><span class="va">rstats_df</span><span class="op">$</span><span class="va">video_url</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">fromJSON</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Parsing the result into a list using <code>fromJSON</code>, results
in a rather complex nested list. You can look through this and see for
yourself if the data you are interested in is there</p>
</div>
<div class="section level3">
<h3 id="get-followers-and-who-a-user-is-following">Get followers and who a user is following<a class="anchor" aria-label="anchor" href="#get-followers-and-who-a-user-is-following"></a>
</h3>
<p>Getting followers and who a user is following is (at the moment?) a
little tricky to use, since TikTok blocks requests to a users profile
page with anti-scraping measures. To circumvent that, you can open a
users page in your browser and then right-click to show the source
code:<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt; You can of course also use tools like &lt;a href="https://playwright.dev/" class="external-link"&gt;Playwright&lt;/a&gt;, &lt;a href="https://www.selenium.dev/" class="external-link"&gt;Selenium&lt;/a&gt;, or &lt;a href="https://pptr.dev/" class="external-link"&gt;&lt;/a&gt; to automate this process. But that is
beyond the scope of this vignette and package.&lt;/p&gt;'><sup>1</sup></a></p>
<p><img src="source-code.png"></p>
<p>You can then search for and copy the <code>authorSecId</code>
value:</p>
<p><img src="secuid.png"></p>
<p>Once you have this <code>authorSecId</code> you can look up a maximum
of 5,000 followers per account:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tt_get_following_hidden.html">tt_get_follower</a></span><span class="op">(</span>secuid <span class="op">=</span> <span class="st">"MS4wLjABAAAAwiH32UMb5RenqEN7duyfLIeGQgSIx9WtgtOILt55q6ueUXgz4gHqZC5HFx4nabPi"</span>,</span>
<span>                verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # A tibble: 1,116 × 27</span></span>
<span><span class="co">#&gt;    avatarLarger             avatarMedium avatarThumb commentSetting</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                    &lt;chr&gt;        &lt;chr&gt;                &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1 https://p16-sign-sg.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt;  2 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt;  3 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt;  4 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt;  5 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt;  6 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt;  7 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt;  8 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt;  9 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt; 10 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt; # ℹ 1,106 more rows</span></span>
<span><span class="co">#&gt; # ℹ 23 more variables: downloadSetting &lt;int&gt;, duetSetting &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   ftc &lt;lgl&gt;, id &lt;chr&gt;, isADVirtual &lt;lgl&gt;, nickname &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   openFavorite &lt;lgl&gt;, privateAccount &lt;lgl&gt;, relation &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   secUid &lt;chr&gt;, secret &lt;lgl&gt;, signature &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   stitchSetting &lt;int&gt;, ttSeller &lt;lgl&gt;, uniqueId &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   verified &lt;lgl&gt;, diggCount &lt;int&gt;, followerCount &lt;int&gt;, …</span></span></code></pre></div>
<p>Likewise, you can also check who this account follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tt_get_following_hidden.html">tt_get_following</a></span><span class="op">(</span>secuid <span class="op">=</span> <span class="st">"MS4wLjABAAAAwiH32UMb5RenqEN7duyfLIeGQgSIx9WtgtOILt55q6ueUXgz4gHqZC5HFx4nabPi"</span>,</span>
<span>                 verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # A tibble: 489 × 28</span></span>
<span><span class="co">#&gt;    avatarLarger             avatarMedium avatarThumb commentSetting</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                    &lt;chr&gt;        &lt;chr&gt;                &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt;  2 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt;  3 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt;  4 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt;  5 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt;  6 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt;  7 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt;  8 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt;  9 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt; 10 https://p16-sign-va.tik… https://p16… https://p1…              0</span></span>
<span><span class="co">#&gt; # ℹ 479 more rows</span></span>
<span><span class="co">#&gt; # ℹ 24 more variables: downloadSetting &lt;int&gt;, duetSetting &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   ftc &lt;lgl&gt;, id &lt;chr&gt;, isADVirtual &lt;lgl&gt;, nickname &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   openFavorite &lt;lgl&gt;, privateAccount &lt;lgl&gt;, relation &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   secUid &lt;chr&gt;, secret &lt;lgl&gt;, signature &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   stitchSetting &lt;int&gt;, ttSeller &lt;lgl&gt;, uniqueId &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   verified &lt;lgl&gt;, diggCount &lt;int&gt;, followerCount &lt;int&gt;, …</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">".mp4"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"rstats"</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Johannes B. Gruber.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
